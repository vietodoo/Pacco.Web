@page "/counter"
@using System.Text.Json.Serialization
@using Pacco.Web.Clients
@inject IIdentityServiceClient IdentityServiceClient;

<button class="btn btn-primary" @onclick="@SignUpAsync">Sign up</button>
<button class="btn btn-primary" @onclick="@SignInAsync">Sign in</button>
<button class="btn btn-primary" @onclick="@GetAccount">Get account</button>

@functions {
    int currentCount = 0;

    void IncrementCount()
    {
        currentCount++;
    }

    string token = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJmZGExMGZjZjJkYjI0YTVhOWMyMmQ5NzUxOGYxNzQ4OSIsInVuaXF1ZV9uYW1lIjoiZmRhMTBmY2YyZGIyNGE1YTljMjJkOTc1MThmMTc0ODkiLCJqdGkiOiIyZmE4YzU5Ny1jZjcxLTRiNWItYTIxMC03ODkxZDM3NzFkNTMiLCJpYXQiOiIxNTYyMzU2OTQyMTY3IiwiaHR0cDovL3NjaGVtYXMubWljcm9zb2Z0LmNvbS93cy8yMDA4LzA2L2lkZW50aXR5L2NsYWltcy9yb2xlIjoidXNlciIsIm5iZiI6MTU2MjM1Njk0MiwiZXhwIjoxNTYyMzYwNTQyLCJpc3MiOiJwYWNjbyJ9.-Mxppgv2fEkA7s5Kmgq6EEndAt5Z4NECTYQKx2pN-Gg";
    
    async Task SignUpAsync()
    {
        await IdentityServiceClient.SignUpAsync("user1@test.com", "secret", "user");
    }
    
    async Task SignInAsync()
    {
        var jwt = await IdentityServiceClient.SignInAsync("pacco-user1@mailinator.com", "secret");
        Console.WriteLine(JsonSerializer.ToString(jwt));
    }
    
    async Task GetAccount()
    {
        var account = await IdentityServiceClient.GetAccountAsync(token);
        Console.WriteLine(JsonSerializer.ToString(account));
    }
}